<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Spotify NP Script (Local Edition) v1.5</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: sans-serif; line-height: 1.6; max-width: 800px; margin: auto; padding: 1rem; }
    header, nav, section, footer { margin-bottom: 2rem; }
    nav a { margin-right: 1rem; text-decoration: none; color: #0366d6; }
    pre { background: #f6f8fa; padding: 1rem; overflow-x: auto; }
    code { background: #f6f8fa; padding: 0.2rem 0.4rem; }
    h1, h2 { color: #24292e; }
  </style>
</head>
<body>

  <header>
    <h1>Spotify NP Script (Local Edition) v1.5</h1>
    <p><strong>Maker:</strong> blind_peer</p>
    <p>A purely local “Now Playing” bookmarklet for chat clients—secure PKCE OAuth, automatic token refresh, no external servers.</p>
  </header>

  <nav>
    <a href="#features">Features</a>
    <a href="#installation">Installation</a>
    <a href="#usage">Usage</a>
    <a href="#files">Files</a>
  </nav>

  <section id="features">
    <h2>Features</h2>
    <ul>
      <li>One-click “Now Playing” via bookmarklet</li>
      <li>Secure PKCE OAuth flow (no client secret in JS)</li>
      <li>Local Flask proxy for token exchange &amp; refresh</li>
      <li>Automatic refresh-token handling (no hourly pop-ups)</li>
      <li>Customizable chat message format: <code>/me is now playing: Artist – Track [Album] (Spotify URL)</code></li>
    </ul>
  </section>

  <section id="installation">
    <h2>Installation</h2>
    <ol>
      <li>Clone or download this repo to a folder on your PC.</li>
      <li>Ensure <code>Python 3.7+</code> is installed and on your <code>PATH</code>.</li>
      <li>Run the installer batch:
        <pre><code>Install_SpotifyNPScript-Local.bat</code></pre>
      </li>
      <li>When prompted, enter your Spotify <strong>Client ID</strong>.</li>
      <li>Confirm “Start both servers now? (Y/N)” to launch:
        <ul>
          <li>HTTP redirect page on <code>http://127.0.0.1:8000</code></li>
          <li>Flask proxy on <code>http://127.0.0.1:8888</code></li>
        </ul>
      </li>
      <li>In your Spotify Dashboard, add the Redirect URI:
        <pre><code>http://127.0.0.1:8000/index.html</code></pre>
      </li>
      <li>Copy the bookmarklet code from <code>bookmarklet.txt</code> into a new browser bookmark.</li>
    </ol>
  </section>

  <section id="usage">
    <h2>Usage</h2>
    <ol>
      <li>Ensure both servers are running (<code>run-all-servers.bat</code>).</li>
      <li>On any page with <code>cb().say</code> available, click the bookmarklet.</li>
      <li>First use: authorize in the Spotify popup; it will auto-close.</li>
      <li>Your chat will receive:
        <pre><code>/me is now playing: Artist – Track [Album] (https://open.spotify.com/...)</code></pre>
      </li>
      <li>Subsequent clicks handle token refresh automatically.</li>
    </ol>
  </section>

  <section id="files">
    <h2>Core Files</h2>
    <ul>
      <li><code>index.html</code> — this landing page</li>
      <li><code>proxy.py</code> — Flask proxy for <code>/api/token</code> &amp; <code>/api/refresh</code></li>
      <li><code>run-proxy-py.bat</code> — launches <code>proxy.py</code> inside a venv</li>
      <li><code>run-all-servers.bat</code> — starts both redirect server &amp; proxy</li>
      <li><code>bookmarklet.txt</code> — your one-line bookmarklet</li>
    </ul>
  </section>

  <footer>
    <p>© 2025 blind_peer • MIT License</p>
  </footer>

</body>
</html>